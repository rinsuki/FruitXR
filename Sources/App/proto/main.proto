edition = "2023";

message ToBrowser {
    oneof message {
        TBVideoInitialize video_initialize = 10;
        TBVideoData video_data = 11;
    }
}

enum VideoCodec {
    UNKNOWN = 0;
    // should we have H.264?
    HEVC = 265;
}

message TBVideoInitialize {
    uint32 eye = 1;
    uint32 initialize_count = 2;
    VideoCodec codec = 3;
    repeated bytes parameter_sets = 4;
}

message TBVideoData {
    uint32 eye = 1;
    uint32 initialize_count = 2;
    bool keyframe = 4;
    bytes content = 3;
}

message FromBrowser {
    oneof message {
        FBInitEncoder init_encoder = 1;
        FBCurrentPosition current_position = 2;
    }
}

message FBInitEncoder {
}

message Position {
    float x = 1;
    float y = 2;
    float z = 3;
}

message Orientation {
    float x = 1;
    float y = 2;
    float z = 3;
    float w = 4;
}

message Transform {
    Position position = 1;
    Orientation orientation = 2;
}

message HandController {
    Transform transform = 1;
    float stick_x = 2;
    float stick_y = 3;
    float squeeze = 4;
    float trigger = 5;
    // see IPCStructs.h
    uint32 buttons = 6;
}

message FBCurrentPosition {
    Transform hmd = 1;
    Transform leftEye = 2;
    Transform rightEye = 3;
    HandController leftController = 4;
    HandController rightController = 5;
}
